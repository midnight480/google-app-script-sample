# 実装計画

- [x] 1. プロジェクト構造とコア設定の作成
  - Google Apps Scriptプロジェクトの初期化とclasp設定
  - appsscript.jsonでタイムゾーン、ランタイム、必要なAPIスコープを設定
  - スクリプトプロパティの初期化関数を作成
  - _要件: 6.1_

- [x] 1.1 プロパティテスト用のテストフレームワーク設定
  - **プロパティ1: 包括的入力検証**
  - **検証対象: 要件 1.1, 5.2, 5.5**

- [x] 2. データモデルとバリデーション機能の実装
  - FormSubmission、EventData、ProcessingLogEntryのインターフェース定義
  - 入力検証関数（必須フィールド、日時妥当性、メール形式）の実装
  - _要件: 1.1, 5.2, 5.5_

- [x] 2.1 入力検証のプロパティテスト
  - **プロパティ1: 包括的入力検証**
  - **検証対象: 要件 1.1, 5.2, 5.5**

- [x] 2.2 日時解析のプロパティテスト
  - **プロパティ10: 日時解析柔軟性**
  - **検証対象: 要件 5.4**

- [x] 3. Form Serviceを使用したGoogleフォーム管理機能
  - FormManagerクラスの実装
  - 必須フィールド（登録者メール、開始日時、終了日時、タイトル）の追加
  - オプションフィールド（追加通知先、説明）の追加
  - フォームとスプレッドシートの紐付け
  - _要件: 5.1, 5.3_

- [x] 3.1 オプションフィールド処理のプロパティテスト
  - **プロパティ9: オプションフィールド処理**
  - **検証対象: 要件 5.3**

- [x] 4. 出席者リスト処理機能の実装
  - メールアドレス解析（カンマ区切り対応）
  - 重複排除とメール形式検証
  - 出席者リスト作成機能
  - _要件: 2.1, 2.2, 2.3, 2.4_

- [x] 4.1 出席者リスト処理のプロパティテスト
  - **プロパティ3: 出席者リスト処理**
  - **検証対象: 要件 2.1, 2.2, 2.3, 2.4**

- [x] 5. Google Calendar API統合とMeet URL生成
  - CalendarEventCreatorクラスの実装
  - Calendar APIを使用したイベント作成（Advanced Google Services有効化）
  - Meet URL生成とconferenceData設定
  - 外部アクセス可能なMeet設定
  - 一意リクエストID生成
  - _要件: 1.2, 1.3, 2.5, 6.2, 6.3_

- [x] 5.1 イベント作成とMeet URL生成のプロパティテスト
  - **プロパティ2: イベント作成とMeet URL生成**
  - **検証対象: 要件 1.2, 1.3**
  - 注意: 実際のGoogle Calendar API呼び出しが必要なため、実際の環境でのみ実行可能

- [x] 5.2 外部アクセス設定のプロパティテスト
  - **プロパティ11: 外部アクセス設定**
  - **検証対象: 要件 2.5**
  - 注意: 実際のGoogle Calendar API呼び出しが必要なため、実際の環境でのみ実行可能

- [x] 5.3 一意リクエストID生成のプロパティテスト
  - **プロパティ12: 一意リクエストID生成**
  - **検証対象: 要件 6.3**

- [x] 5.4 Meet URL外部アクセス設定のプロパティテスト
  - **プロパティ13: Meet URL外部アクセス設定**
  - **検証対象: 要件 6.2**
  - 注意: 実際のGoogle Calendar API呼び出しが必要なため、実際の環境でのみ実行可能

- [x] 6. 処理ログ管理と冪等性保証機能
  - ProcessingLoggerクラスの実装
  - スプレッドシートへの処理ログ記録（ステータス、イベントID、タイムスタンプ、エラー詳細）
  - 重複処理チェック機能
  - _要件: 1.4, 4.1, 4.2, 4.3, 4.4_

- [x] 6.1 処理冪等性のプロパティテスト
  - **プロパティ6: 処理冪等性**
  - **検証対象: 要件 4.1, 4.2**

- [x] 6.2 処理ログ完全性のプロパティテスト
  - **プロパティ7: 処理ログ完全性**
  - **検証対象: 要件 1.4, 4.3, 4.4**

- [x] 7. メール通知システムの実装
  - EmailNotificationSenderクラスの実装
  - メール本文テンプレート作成（イベント詳細、Meet URL、カレンダーID、追加手順）
  - 日時フォーマット機能（Asia/Tokyoタイムゾーン対応）
  - MailAppを使用した通知送信
  - _要件: 3.1, 3.2, 3.3, 3.4_

- [x] 7.1 包括的メール通知のプロパティテスト
  - **プロパティ4: 包括的メール通知**
  - **検証対象: 要件 3.1, 3.2, 3.3**
  - 注意: 実際のメール送信が必要なため、実際の環境でのみ実行可能

- [x] 7.2 日時フォーマット一貫性のプロパティテスト
  - **プロパティ5: 日時フォーマット一貫性**
  - **検証対象: 要件 3.4**

- [x] 8. エラーハンドリングと安全性機能
  - 検証失敗時の安全な処理（不完全イベント作成防止）
  - API失敗時のエラーログ記録
  - Meet URL生成失敗時の代替メッセージ
  - _要件: 1.5, 3.5, 4.5, 6.4, 6.5_

- [x] 8.1 検証失敗時の安全性プロパティテスト
  - **プロパティ8: 検証失敗時の安全性**
  - **検証対象: 要件 1.5, 4.5**

- [x] 9. メイン処理統合とonFormSubmitトリガー
  - FormSubmissionProcessorのメイン処理実装
  - onFormSubmitイベントハンドラーの作成
  - 全コンポーネントの統合とワークフロー実装
  - _要件: 1.1, 1.2, 1.3, 1.4, 1.5_

- [x] 10. 設定とデプロイ準備
  - スクリプトプロパティ設定関数（SHARED_CALENDAR_ID: "c_3f32dbf2385c308f36f97924b22ec7ba41bfdb8d090fb8d0a704b01083996db0@group.calendar.google.com"等）
  - initializeScriptProperties関数の実装
  - Advanced Google Services（Calendar API）の有効化手順
  - インストール型トリガーの設定手順
  - README.mdの作成（セットアップ手順、使用方法、セキュリティ設定）
  - _要件: 6.1_

- [ ] 11. 最終チェックポイント - すべてのテストが通ることを確認
  - すべてのテストが通ることを確認し、問題が発生した場合はユーザーに質問する